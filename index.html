<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>VR Club - Quest 3S</title>
  <meta name="description" content="Multiplayer VR Club with Music Streaming">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- External CSS -->
  <link rel="stylesheet" href="css/styles.css">
  
  <!-- A-Frame and Dependencies -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.2.0/dist/aframe-extras.min.js"></script>
  <script src="https://unpkg.com/networked-aframe@^0.11.0/dist/networked-aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/socket.io-client@4.5.1/dist/socket.io.min.js"></script>
</head>
<body>
  <!-- Club Environment Scene -->
  <a-scene 
    networked-scene="
      app: vrclub;
      room: mainclub;
      adapter: wss;
      serverURL: wss://naf-server.herokuapp.com;
      audio: true;
      debug: false;"
    background="color: #000000">
    
    <!-- Assets -->
    <a-assets>
      <!-- Audio element for music stream -->
      <audio id="club-music" crossorigin="anonymous" loop></audio>
      
      <!-- Templates for networked avatars -->
      <template id="avatar-template">
        <a-entity class="avatar">
          <a-sphere class="head" color="#5985ff" radius="0.2" position="0 1.6 0"></a-sphere>
          <a-cylinder class="body" color="#3355dd" radius="0.15" height="0.8" position="0 1.0 0"></a-cylinder>
          <a-entity class="name-tag" 
            text="value: Player; align: center; color: white; width: 2"
            position="0 2.0 0"
            look-at="#camera"></a-entity>
        </a-entity>
      </template>
    </a-assets>

    <!-- Camera Rig (Player) -->
    <a-entity id="rig" movement-controls="speed: 0.3" position="0 0 15">
      <a-entity id="camera" camera position="0 1.6 0" look-controls wasd-controls>
        <a-entity cursor="rayOrigin: mouse" 
          position="0 0 -0.5"
          geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.015"
          material="color: white; shader: flat"></a-entity>
      </a-entity>
      
      <!-- VR Controllers -->
      <a-entity id="leftHand" 
        oculus-touch-controls="hand: left"
        laser-controls
        raycaster="objects: .clickable"></a-entity>
      <a-entity id="rightHand" 
        oculus-touch-controls="hand: right"
        laser-controls
        raycaster="objects: .clickable"></a-entity>
    </a-entity>

    <!-- Networked Players -->
    <a-entity id="player" 
      networked="template:#avatar-template;attachTemplateToLocal:false;"
      position="0 0 0">
    </a-entity>

    <!-- MAIN FLOOR -->
    <a-entity id="main-floor" position="0 0 0">
      
      <!-- Floor -->
      <a-plane rotation="-90 0 0" width="30" height="40" color="#111111" position="0 0 -10"
        shadow="receive: true"
        material="metalness: 0.8; roughness: 0.2"></a-plane>
      
      <!-- Dance Floor Area -->
      <a-entity id="dance-floor" position="0 0.01 -10">
        <a-plane rotation="-90 0 0" width="20" height="20" 
          material="color: #2a2a2a; metalness: 0.2; roughness: 0.8"
          shadow="receive: true"></a-plane>
      </a-entity>

      <!-- DJ Stage -->
      <a-entity id="dj-stage" position="0 0.5 -22">
        <a-box width="8" height="1" depth="4" color="#1a1a1a" 
          material="metalness: 0.5"></a-box>
      </a-entity>

      <!-- DJ Booth -->
      <a-entity id="dj-booth" position="0 1.5 -23">
        <a-box width="3" height="1.5" depth="2" color="#0a0a0a"
          material="metalness: 0.8"></a-box>
        <!-- DJ Equipment -->
        <a-box width="2.5" height="0.3" depth="1.5" color="#222222" position="0 0.9 0"
          material="metalness: 0.9; emissive: #00ff88; emissiveIntensity: 0.3"></a-box>
        <!-- Music Control UI -->
        <a-entity id="music-controls" position="0 1.5 1">
          <a-plane width="2" height="1" color="#000000" opacity="0.8"
            class="clickable music-ui"
            text="value: ðŸŽµ Click to Set Music URL\nLeft Click: Play/Pause; align: center; color: #00ff88; width: 1.8"></a-plane>
        </a-entity>
      </a-entity>

      <!-- Ceiling Truss System -->
      <a-entity id="truss-system">
        <!-- Main truss beam 1 (left side) -->
        <a-entity id="truss-1" position="-7 8 -12">
          <a-box width="0.3" height="0.3" depth="20" color="#2a2a2a"
            material="metalness: 0.9; roughness: 0.3"></a-box>
          <a-box width="0.15" height="0.15" depth="20" color="#1a1a1a" position="0.2 0.2 0"
            material="metalness: 0.8; roughness: 0.4"></a-box>
          <a-box width="0.15" height="0.15" depth="20" color="#1a1a1a" position="-0.2 -0.2 0"
            material="metalness: 0.8; roughness: 0.4"></a-box>
        </a-entity>

        <!-- Main truss beam 2 (center) -->
        <a-entity id="truss-2" position="0 8 -12">
          <a-box width="0.3" height="0.3" depth="20" color="#2a2a2a"
            material="metalness: 0.9; roughness: 0.3"></a-box>
          <a-box width="0.15" height="0.15" depth="20" color="#1a1a1a" position="0.2 0.2 0"
            material="metalness: 0.8; roughness: 0.4"></a-box>
          <a-box width="0.15" height="0.15" depth="20" color="#1a1a1a" position="-0.2 -0.2 0"
            material="metalness: 0.8; roughness: 0.4"></a-box>
        </a-entity>

        <!-- Main truss beam 3 (right side) -->
        <a-entity id="truss-3" position="7 8 -12">
          <a-box width="0.3" height="0.3" depth="20" color="#2a2a2a"
            material="metalness: 0.9; roughness: 0.3"></a-box>
          <a-box width="0.15" height="0.15" depth="20" color="#1a1a1a" position="0.2 0.2 0"
            material="metalness: 0.8; roughness: 0.4"></a-box>
          <a-box width="0.15" height="0.15" depth="20" color="#1a1a1a" position="-0.2 -0.2 0"
            material="metalness: 0.8; roughness: 0.4"></a-box>
        </a-entity>

        <!-- Cross truss beams -->
        <a-entity id="truss-cross-1" position="0 8 -6">
          <a-box width="14" height="0.3" depth="0.3" color="#2a2a2a"
            material="metalness: 0.9; roughness: 0.3"></a-box>
        </a-entity>

        <a-entity id="truss-cross-2" position="0 8 -12">
          <a-box width="14" height="0.3" depth="0.3" color="#2a2a2a"
            material="metalness: 0.9; roughness: 0.3"></a-box>
        </a-entity>

        <a-entity id="truss-cross-3" position="0 8 -18">
          <a-box width="14" height="0.3" depth="0.3" color="#2a2a2a"
            material="metalness: 0.9; roughness: 0.3"></a-box>
        </a-entity>

        <!-- Vertical support cables -->
        <a-cylinder radius="0.02" height="8" position="-7 4 -6" color="#3a3a3a"
          material="metalness: 0.9; roughness: 0.2"></a-cylinder>
        <a-cylinder radius="0.02" height="8" position="7 4 -6" color="#3a3a3a"
          material="metalness: 0.9; roughness: 0.2"></a-cylinder>
        <a-cylinder radius="0.02" height="8" position="-7 4 -18" color="#3a3a3a"
          material="metalness: 0.9; roughness: 0.2"></a-cylinder>
        <a-cylinder radius="0.02" height="8" position="7 4 -18" color="#3a3a3a"
          material="metalness: 0.9; roughness: 0.2"></a-cylinder>
      </a-entity>

      <!-- Disco Ball (hanging from center truss) -->
      <a-entity id="disco-ball" position="0 6.5 -12">
        <!-- Hanging cable -->
        <a-cylinder radius="0.02" height="1.5" position="0 0.75 0" color="#1a1a1a"
          material="metalness: 0.9; roughness: 0.2"></a-cylinder>
        <!-- Ball -->
        <a-sphere radius="0.6" 
          material="metalness: 1; roughness: 0; color: #ffffff"
          animation="property: rotation; to: 0 360 0; loop: true; dur: 10000; easing: linear"></a-sphere>
        <a-entity light="type: point; intensity: 2; color: #ffffff; distance: 20"></a-entity>
      </a-entity>

      <!-- Laser System with Visible Sources -->
      <a-entity id="laser-system">
        <!-- Laser Emitters (visible sources) -->
        <a-entity id="laser-emitters"></a-entity>
        <!-- Laser Beams -->
        <a-entity id="lasers"></a-entity>
      </a-entity>

      <!-- Light Beam System (Mounted on Truss) -->
      <a-entity id="light-beams">
        <!-- Moving spotlights with visible fixtures mounted on truss -->
        <a-entity id="spotlight-1" position="-7 7.5 -12">
          <!-- Mounting bracket -->
          <a-box width="0.2" height="0.3" depth="0.2" position="0 0.4 0" color="#2a2a2a"
            material="metalness: 0.9; roughness: 0.3"></a-box>
          <!-- Clamp -->
          <a-cylinder radius="0.15" height="0.15" rotation="90 0 0" position="0 0.55 0" color="#3a3a3a"
            material="metalness: 0.8; roughness: 0.4"></a-cylinder>
          <!-- Fixture body -->
          <a-cone radiusBottom="0.4" radiusTop="0.25" height="0.6" rotation="180 0 0" color="#0a0a0a" 
            material="metalness: 0.9; roughness: 0.2"></a-cone>
          <!-- Lens -->
          <a-circle radius="0.22" rotation="180 0 0" position="0 -0.31 0"
            material="color: #1a1a1a; metalness: 0.9; roughness: 0.1; emissive: #ff0000; emissiveIntensity: 0.5"></a-circle>
          <!-- Light -->
          <a-entity light="type: spot; angle: 25; intensity: 0; color: #ff0000; distance: 30; penumbra: 0.5"
            position="0 -0.3 0"
            animation="property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear"></a-entity>
        </a-entity>
        
        <a-entity id="spotlight-2" position="7 7.5 -12">
          <a-box width="0.2" height="0.3" depth="0.2" position="0 0.4 0" color="#2a2a2a"
            material="metalness: 0.9; roughness: 0.3"></a-box>
          <a-cylinder radius="0.15" height="0.15" rotation="90 0 0" position="0 0.55 0" color="#3a3a3a"
            material="metalness: 0.8; roughness: 0.4"></a-cylinder>
          <a-cone radiusBottom="0.4" radiusTop="0.25" height="0.6" rotation="180 0 0" color="#0a0a0a" 
            material="metalness: 0.9; roughness: 0.2"></a-cone>
          <a-circle radius="0.22" rotation="180 0 0" position="0 -0.31 0"
            material="color: #1a1a1a; metalness: 0.9; roughness: 0.1; emissive: #00ff00; emissiveIntensity: 0.5"></a-circle>
          <a-entity light="type: spot; angle: 25; intensity: 0; color: #00ff00; distance: 30; penumbra: 0.5"
            position="0 -0.3 0"
            animation="property: rotation; to: 0 -360 0; loop: true; dur: 7000; easing: linear"></a-entity>
        </a-entity>
        
        <a-entity id="spotlight-3" position="0 7.5 -6">
          <a-box width="0.2" height="0.3" depth="0.2" position="0 0.4 0" color="#2a2a2a"
            material="metalness: 0.9; roughness: 0.3"></a-box>
          <a-cylinder radius="0.15" height="0.15" rotation="90 0 0" position="0 0.55 0" color="#3a3a3a"
            material="metalness: 0.8; roughness: 0.4"></a-cylinder>
          <a-cone radiusBottom="0.4" radiusTop="0.25" height="0.6" rotation="180 0 0" color="#0a0a0a" 
            material="metalness: 0.9; roughness: 0.2"></a-cone>
          <a-circle radius="0.22" rotation="180 0 0" position="0 -0.31 0"
            material="color: #1a1a1a; metalness: 0.9; roughness: 0.1; emissive: #0000ff; emissiveIntensity: 0.5"></a-circle>
          <a-entity light="type: spot; angle: 25; intensity: 0; color: #0000ff; distance: 30; penumbra: 0.5"
            position="0 -0.3 0"
            animation="property: rotation; to: 360 0 0; loop: true; dur: 6000; easing: linear"></a-entity>
        </a-entity>

        <a-entity id="spotlight-4" position="-3.5 7.5 -18">
          <a-box width="0.2" height="0.3" depth="0.2" position="0 0.4 0" color="#2a2a2a"
            material="metalness: 0.9; roughness: 0.3"></a-box>
          <a-cylinder radius="0.15" height="0.15" rotation="90 0 0" position="0 0.55 0" color="#3a3a3a"
            material="metalness: 0.8; roughness: 0.4"></a-cylinder>
          <a-cone radiusBottom="0.4" radiusTop="0.25" height="0.6" rotation="180 0 0" color="#0a0a0a" 
            material="metalness: 0.9; roughness: 0.2"></a-cone>
          <a-circle radius="0.22" rotation="180 0 0" position="0 -0.31 0"
            material="color: #1a1a1a; metalness: 0.9; roughness: 0.1; emissive: #ff00ff; emissiveIntensity: 0.5"></a-circle>
          <a-entity light="type: spot; angle: 30; intensity: 0; color: #ff00ff; distance: 25; penumbra: 0.5"
            position="0 -0.3 0"
            animation="property: rotation; to: 45 360 0; loop: true; dur: 4500; easing: linear"></a-entity>
        </a-entity>

        <a-entity id="spotlight-5" position="3.5 7.5 -18">
          <a-box width="0.2" height="0.3" depth="0.2" position="0 0.4 0" color="#2a2a2a"
            material="metalness: 0.9; roughness: 0.3"></a-box>
          <a-cylinder radius="0.15" height="0.15" rotation="90 0 0" position="0 0.55 0" color="#3a3a3a"
            material="metalness: 0.8; roughness: 0.4"></a-cylinder>
          <a-cone radiusBottom="0.4" radiusTop="0.25" height="0.6" rotation="180 0 0" color="#0a0a0a" 
            material="metalness: 0.9; roughness: 0.2"></a-cone>
          <a-circle radius="0.22" rotation="180 0 0" position="0 -0.31 0"
            material="color: #1a1a1a; metalness: 0.9; roughness: 0.1; emissive: #ffff00; emissiveIntensity: 0.5"></a-circle>
          <a-entity light="type: spot; angle: 30; intensity: 0; color: #ffff00; distance: 25; penumbra: 0.5"
            position="0 -0.3 0"
            animation="property: rotation; to: -45 -360 0; loop: true; dur: 5500; easing: linear"></a-entity>
        </a-entity>
      </a-entity>

      <!-- Additional Lighting Types (Mounted on Truss) -->
      <a-entity id="strobe-lights">
        <!-- Strobe lights mounted on truss -->
        <a-entity id="strobe-1" position="-7 7.5 -8">
          <!-- Mounting bracket -->
          <a-box width="0.15" height="0.25" depth="0.15" position="0 0.35 0" color="#2a2a2a"
            material="metalness: 0.9; roughness: 0.3"></a-box>
          <!-- Strobe housing -->
          <a-box width="0.4" height="0.4" depth="0.4" color="#0a0a0a"
            material="metalness: 0.9; roughness: 0.2"></a-box>
          <!-- Lens -->
          <a-plane width="0.35" height="0.35" position="0 0 0.21"
            material="color: #ffffff; emissive: #ffffff; emissiveIntensity: 0; metalness: 0.9; roughness: 0.1"></a-plane>
          <a-entity light="type: point; intensity: 0; color: #ffffff; distance: 15"></a-entity>
        </a-entity>
        
        <a-entity id="strobe-2" position="7 7.5 -8">
          <a-box width="0.15" height="0.25" depth="0.15" position="0 0.35 0" color="#2a2a2a"
            material="metalness: 0.9; roughness: 0.3"></a-box>
          <a-box width="0.4" height="0.4" depth="0.4" color="#0a0a0a"
            material="metalness: 0.9; roughness: 0.2"></a-box>
          <a-plane width="0.35" height="0.35" position="0 0 0.21"
            material="color: #ffffff; emissive: #ffffff; emissiveIntensity: 0; metalness: 0.9; roughness: 0.1"></a-plane>
          <a-entity light="type: point; intensity: 0; color: #ffffff; distance: 15"></a-entity>
        </a-entity>

        <a-entity id="strobe-3" position="0 7.5 -4">
          <a-box width="0.15" height="0.25" depth="0.15" position="0 0.35 0" color="#2a2a2a"
            material="metalness: 0.9; roughness: 0.3"></a-box>
          <a-box width="0.4" height="0.4" depth="0.4" color="#0a0a0a"
            material="metalness: 0.9; roughness: 0.2"></a-box>
          <a-plane width="0.35" height="0.35" position="0 0 0.21"
            material="color: #ffffff; emissive: #ffffff; emissiveIntensity: 0; metalness: 0.9; roughness: 0.1"></a-plane>
          <a-entity light="type: point; intensity: 0; color: #ffffff; distance: 15"></a-entity>
        </a-entity>

        <a-entity id="strobe-4" position="-7 7.5 -16">
          <a-box width="0.15" height="0.25" depth="0.15" position="0 0.35 0" color="#2a2a2a"
            material="metalness: 0.9; roughness: 0.3"></a-box>
          <a-box width="0.4" height="0.4" depth="0.4" color="#0a0a0a"
            material="metalness: 0.9; roughness: 0.2"></a-box>
          <a-plane width="0.35" height="0.35" position="0 0 0.21"
            material="color: #ffffff; emissive: #ffffff; emissiveIntensity: 0; metalness: 0.9; roughness: 0.1"></a-plane>
          <a-entity light="type: point; intensity: 0; color: #ffffff; distance: 15"></a-entity>
        </a-entity>

        <a-entity id="strobe-5" position="7 7.5 -16">
          <a-box width="0.15" height="0.25" depth="0.15" position="0 0.35 0" color="#2a2a2a"
            material="metalness: 0.9; roughness: 0.3"></a-box>
          <a-box width="0.4" height="0.4" depth="0.4" color="#0a0a0a"
            material="metalness: 0.9; roughness: 0.2"></a-box>
          <a-plane width="0.35" height="0.35" position="0 0 0.21"
            material="color: #ffffff; emissive: #ffffff; emissiveIntensity: 0; metalness: 0.9; roughness: 0.1"></a-plane>
          <a-entity light="type: point; intensity: 0; color: #ffffff; distance: 15"></a-entity>
        </a-entity>
      </a-entity>

      <!-- LED Wall Panels (Behind DJ) -->
      <a-entity id="led-wall-panels">
        <a-entity id="led-panel-1" position="-3 3 -23.5">
          <a-plane width="2" height="2" rotation="0 0 0"
            material="color: #ff0000; emissive: #ff0000; emissiveIntensity: 0; metalness: 0.5"></a-plane>
        </a-entity>
        
        <a-entity id="led-panel-2" position="0 3 -23.5">
          <a-plane width="2" height="2" rotation="0 0 0"
            material="color: #00ff00; emissive: #00ff00; emissiveIntensity: 0; metalness: 0.5"></a-plane>
        </a-entity>

        <a-entity id="led-panel-3" position="3 3 -23.5">
          <a-plane width="2" height="2" rotation="0 0 0"
            material="color: #0000ff; emissive: #0000ff; emissiveIntensity: 0; metalness: 0.5"></a-plane>
        </a-entity>
      </a-entity>

      <!-- Walls -->
      <a-box width="0.5" height="8" depth="40" position="-15 4 -12" color="#0a0a0a"
        material="metalness: 0.5"></a-box>
      <a-box width="0.5" height="8" depth="40" position="15 4 -12" color="#0a0a0a"
        material="metalness: 0.5"></a-box>
      <a-box width="30" height="8" depth="0.5" position="0 4 -24" color="#0a0a0a"
        material="metalness: 0.5"></a-box>
      <a-box width="30" height="8" depth="0.5" position="0 4 0" color="#0a0a0a"
        material="metalness: 0.5"></a-box>
    </a-entity>

    <!-- Ceiling -->
    <a-plane rotation="90 0 0" width="30" height="40" color="#000000" position="0 8 -12"
      material="metalness: 0.5; roughness: 0.5"></a-plane>

    <!-- Ambient Lighting (Environmental) -->
    <a-entity light="type: ambient; color: #0a0a0a; intensity: 0.2"></a-entity>

    <!-- Environment Fog -->
    <a-entity id="fog" fog="type: linear; color: #000011; near: 3; far: 35"></a-entity>

  </a-scene>

  <!-- External JavaScript Modules -->
  <script src="js/club-environment.js"></script>
  <script src="js/init.js"></script>
</body>
</html>
